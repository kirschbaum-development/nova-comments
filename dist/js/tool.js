!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e){t.exports=function(t,e,n,r,o,s){var a,i=t=t||{},c=typeof t.default;"object"!==c&&"function"!==c||(a=t,i=t.default);var m,u="function"==typeof i?i.options:i;if(e&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0),n&&(u.functional=!0),o&&(u._scopeId=o),s?(m=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),r&&r.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},u._ssrRegister=m):r&&(m=r),m){var l=u.functional,d=l?u.render:u.beforeCreate;l?(u._injectStyles=m,u.render=function(t,e){return m.call(e),d(t,e)}):u.beforeCreate=d?[].concat(d,m):[m]}return{esModule:a,exports:i,options:u}}},function(t,e,n){n(2),t.exports=n(9)},function(t,e,n){Nova.booting(function(t){t.component("commenter",n(3))})},function(t,e,n){var r=n(0)(n(4),n(8),!1,null,null,null);t.exports=r.exports},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),o=n.n(r);e.default={props:["resourceName","resourceId","field"],components:{Comment:o.a},data:function(){return{baseCommentUri:"/nova-api/comments",comment:"",data:{next_page_url:"",prev_page_url:"",resources:{}}}},mounted:function(){this.getComments(this.commentsUri)},computed:{commentsUri:function(){return this.baseCommentUri+"?page=1"},hasComments:function(){return Boolean(this.data.resources.length)},hasNextLink:function(){return Boolean(this.data.next_page_url)},hasPrevLink:function(){return Boolean(this.data.prev_page_url)},hasPagination:function(){return this.hasNextLink||this.hasPrevLink},queryParams:function(){return"&orderBy=created_at&orderByDirection=desc&viaResource="+this.resourceName+"&viaResourceId="+this.resourceId+"&viaRelationship=comments&relationshipType=hasMany"}},methods:{createComment:function(){var t=this;if(!this.comment)return!1;var e={comment:this.comment,viaResource:this.resourceName,viaResourceId:this.resourceId,viaRelationship:"comments"};axios.post(this.baseCommentUri,e).then(function(){t.getComments(t.commentsUri),t.resetComment(),t.$toasted.show(Nova.app.__("A new comment has been created."),{type:"success"})}).catch(function(e){return t.$toasted.show(e,{type:"error"})})},getComments:function(t){var e=this;axios.get(""+t+this.queryParams).then(function(t){var n=t.data;return e.data=n})},paginationClass:function(t){return t?"text-primary dim":"text-80 opacity-50"},resetComment:function(){this.comment=""}}}},function(t,e,n){var r=n(0)(n(6),n(7),!1,null,null,null);t.exports=r.exports},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{comment:{type:Object,required:!0}},computed:{commentString:function(){return _.find(this.comment.fields,{attribute:"comment"}).value},commenter:function(){return _.find(this.comment.fields,{attribute:"commenter"}).value},commenterUrl:function(){return"/nova/resources/users/"+_.find(this.comment.fields,{attribute:"commenter"}).belongsToId},date:function(){var t=Nova.app.__("Moment Locale");moment.locale(t);var e=moment(),n=moment.utc(_.find(this.comment.fields,{attribute:"created_at"}).value).tz(moment.tz.guess());return n.isSame(e,"minute")?Nova.app.__("just now"):n.isSame(e,"day")?Nova.app.__("at")+" "+n.format("LT"):n.isSame(e,"year")?Nova.app.__("on")+" "+("de"===t?n.format("D MMM"):n.format("MMM D")):Nova.app.__("on")+" "+n.format("ll")},hasCommenter:function(){return Boolean(this.commenter)}}}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"commenter__comment py-4 border-t border-40"},[n("div",{staticClass:"font-light text-80 text-sm"},[t.hasCommenter?[n("a",{staticClass:"no-underline dim text-primary font-bold",attrs:{href:t.commenterUrl},domProps:{textContent:t._s(t.commenter)}}),t._v("\n\n            "+t._s(t.__("said"))+"\n        ")]:[t._v("\n            "+t._s(t.__("Written"))+"\n        ")],t._v("\n\n        "+t._s(t.date)+"\n    ")],2),t._v(" "),n("div",{staticClass:"mt-2",domProps:{innerHTML:t._s(t.commentString)}})])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h4",{staticClass:"text-90 font-normal text-2xl mb-3"},[t._v("\n        "+t._s(t.__("Comments"))+"\n    ")]),t._v(" "),n("div",{staticClass:"card mb-6 overflow-hidden"},[n("div",{staticClass:"flex border-b border-40 remove-bottom-border px-8"},[n("div",{staticClass:"w-full pt-6 pb-2"},[n("h4",{staticClass:"font-normal text-80"},[t._v("\n                    "+t._s(t.__("Write new comment"))+"\n                ")]),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],staticClass:"w-full form-control form-input form-input-bordered py-3 h-auto mt-2",attrs:{id:"commenter",dusk:"commenter",rows:"5"},domProps:{value:t.comment},on:{keyup:function(e){return!e.type.indexOf("key")&&93!==e.keyCode&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.createComment(e)},input:function(e){e.target.composing||(t.comment=e.target.value)}}})])]),t._v(" "),n("div",{staticClass:"flex justify-between px-8 pb-4 border-b border-40"},[n("div",{staticClass:"help-text"},[t._v("\n                "+t._s(t.__("On MacOS, press âŒ˜ + Enter to save"))+"\n            ")]),t._v(" "),n("button",{staticClass:"btn btn-default btn-primary inline-flex items-center relative mt-4",attrs:{type:"submit"},on:{click:t.createComment}},[t._v("\n                "+t._s(t.__("Save Comment"))+"\n            ")])]),t._v(" "),t.hasComments?n("div",{staticClass:"flex border-b border-40 remove-bottom-border px-8"},[n("div",{staticClass:"w-full py-6"},[n("h3",{staticClass:"text-90 font-bold text-lg mb-4"},[t._v(t._s(t.__("Comments")))]),t._v(" "),t._l(t.data.resources,function(t,e){return n("comment",{key:e,attrs:{comment:t}})})],2)]):t._e(),t._v(" "),t.hasPagination?n("div",{staticClass:"bg-20 rounded-b"},[n("nav",{staticClass:"flex justify-between items-center"},[n("button",{staticClass:"btn btn-link py-3 px-4",class:t.paginationClass(t.hasNextLink),attrs:{disabled:!t.hasNextLink},on:{click:function(e){return t.getComments(t.data.next_page_url)}}},[t._v("\n                    "+t._s(t.__("Older"))+"\n                ")]),t._v(" "),n("button",{staticClass:"btn btn-link py-3 px-4",class:t.paginationClass(t.hasPrevLink),attrs:{disabled:!t.hasPrevLink},on:{click:function(e){return t.getComments(t.data.prev_page_url)}}},[t._v("\n                    "+t._s(t.__("Newer"))+"\n                ")])])]):t._e()])])},staticRenderFns:[]}},function(t,e){}]);